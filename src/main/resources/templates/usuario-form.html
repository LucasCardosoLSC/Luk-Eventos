<th:block th:fragment="content">
    <div class="container mt-5">
        <h1 th:text="${usuario.id == null ? 'Novo Usuário' : 'Editar Usuário'}"></h1>
        
        <div th:if="${mensagem}" class="alert alert-success" role="alert">
            <span th:text="${mensagem}"></span>
        </div>
        
        <div th:if="${erro}" class="alert alert-danger" role="alert">
            <span th:text="${erro}"></span>
        </div>
        
        <form th:action="${usuario.id == null ? '/usuarios' : '/usuarios/' + usuario.id}" method="post">
            <div class="form-group">
                <label for="nome">Nome</label>
                <input type="text" class="form-control" id="nome" name="nome" th:value="${usuario.nome}" required>
            </div>
            
            <div class="form-group">
                <label for="email">Email</label>
                <input type="email" class="form-control" id="email" name="email" th:value="${usuario.email}" required>
            </div>
            
            <div class="form-group">
                <label for="senha">Senha</label>
                <input type="password" class="form-control" id="senha" name="senha" th:required="${usuario.id == null}">
                <small class="form-text text-muted" th:if="${usuario.id != null}">Deixe em branco para manter a senha atual</small>
            </div>
            
            <div class="form-group">
                <label for="perfis">Perfis</label>
                <select class="form-control" id="perfis" name="perfis" multiple required>
                    <option th:each="perfil : ${perfis}" 
                            th:value="${perfil.id}" 
                            th:text="${perfil.nome}"
                            th:selected="${usuario.perfis != null && usuario.perfis.contains(perfil)}">
                    </option>
                </select>
            </div>
            
            <div class="form-group">
                <div class="custom-control custom-checkbox">
                    <input type="checkbox" class="custom-control-input" id="ativo" name="ativo" th:checked="${usuario.ativo}">
                    <label class="custom-control-label" for="ativo">Ativo</label>
                </div>
            </div>
            
            <button type="submit" class="btn btn-primary">Salvar</button>
            <a th:href="@{/usuarios}" class="btn btn-secondary">Cancelar</a>
        </form>
    </div>
</th:block> 